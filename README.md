### SimpleExcel

SimpleExcel - упрощённый аналог существующих электронных таблиц, таких как лист таблицы Microsoft Excel или Google Sheets. В ячейках таблицы могут быть текст или формулы. Формулы, как и в существующих решениях, могут содержать индексы ячеек. Формулы разбираются при помощи специальной программы ANTLR, которая генерирует код лексического и синтаксического анализаторов, а также код для обхода дерева разбора на С++.

### Рекомендации по сборке проекта

---

1. Установите [Java SE Runtime Environment 8](https://www.oracle.com/java/technologies/javase-jre8-downloads.html)
2. Установите [ANTLR](https://www.antlr.org/) (ANother Tool for Language Recognition), выполнив все пункты в меню Quick Start
3. Проверте название файла antlr-4.9.2-complete.jar в файлах FindANTLR.cmake и CMakeLists.txt, если оно отличается, то поправьете название.
4. Создайте папку antlr4_formula, скопируйте в неё файл Formula.g4, перейдите в неё и выполните команду:

```cpp
antlr4 -Dlanguage=Cpp Formula.g4
```

5. Создайте папку antlr4_runtime и скачайте в неё [файлы](https://github.com/antlr/antlr4/tree/master/runtime/Cpp).
6. Всё остальное сделает CMakeLists.txt!

## Реализация

---

### Структура Position

---

За работу с позициями отвечает структура __Position__ в файле *position.h*.
Она содержит поля __int row__ и __int col__ — номера строки и столбца ячейки в программном представлении.
__Position__ используются для доступа к ячейкам.

Основные методы:
- __FromString(std::string_view str)__ — возвращает позицию, соответствующую индексу, заданному в str.
Если индекс задан в неверном формате — "abc", "111", "12jfd" — или выходит за предельные значения (которые описаны ниже), он не валиден. Тогда функция возвращает дефолтную позицию __Position::NONE__. Она объявлена как {-1, -1}.

- __bool IsValid()__ — проверяет валидность позиции, то есть что ячейка (row, col) не выходит за ограничения ниже и что значения полей row и col неотрицательны. __Position::NONE__ невалидна.

- __std::string ToString()__ — возвращает строку — позицию в формате пользовательского индекса. Если позиция невалидна, метод должен вернуть пустую строку.

##### Ограничения:
Количество строк и столбцов в таблице не должно превышаеть 16384.
То есть предельная позиция ячейки — (16383, 16383) с индексом “XFD16384”.
Если позиция ячейки выходит за эти границы, то она не валидна по определению.

##### Пример
Если ячейка имеет индекс “А1”, то её позиция (0, 0).
Если ячейка имеет индекс “AB15”, то её позиция (14, 27).

### Класс Cell
---

Лист электронной таблицы содержит ячейки с данными которые представлены клссом Cell.
Пользователь задаёт ячейке некий текст. В зависимости от содержания программа определяет его по-разному, например: как обычный текст (std::string) или формулу (double). С ячейками разных типов можно совершать разные операции.

##### Типы ячеек
Ячейки могут трактоваться как текстовые и формульные. Тип зависит от текста, который пользователь задал в методе __Cell::Set()__.
Ячейка формульная, если её текст начинается со знака "=". То, что следует после знака "=", называется выражением формулы.
Все остальные ячейки трактуются как текстовые.
Тип существующей ячейки может меняться, если пользователь задал в ячейке новый текст методом __Set()__: формульная ячейка может стать текстовой и наоборот.

##### Представление ячеек
Для всех типов ячеек существует два представления:
Текст — метод __GetText()__. «Сырое» содержимое ячейки, строка:
для текстовой ячейки — строка, которую пользователь задал в методе __Set()__;
для формульной — строка-формула, «очищенная» от лишних скобок и ведущего знака "=".
Значение ячейки — метод __GetValue()__. Может быть текстом для текстовых ячеек, числом или __FormulaError__ для формульных.

##### Формульная ячейка
Ячейка трактуется как формульная, если её текст начинается со знака "=". Пробелы перед знаком "=" не игнорируются, то есть ячейка, заданная текстом: " =1+2", не считается формульной.
То, что следует после знака "=", называется выражением формулы.
Если в методе __Set()__ в ячейку записывают синтаксически некорректную формулу, например, "=hd+2-+3((//)(112", реализация выбросит исключение __FormulaException__, а значение ячейки не изменится. Это нужно, чтобы в таблице не возникло синтаксически некорректных формул.
Метод __Set()__ позволяет записать в ячейку формулу, которая приводит к ошибке вычисления, например "=1/0". В этом случае метод __GetValue()__ вернёт __FormulaError__.

Все ячейки, кроме формульных, трактуются как текстовые. Обычно для них результат метода __GetValue()__ совпадает с результатом метода __GetText()__. Кроме случая, когда текст начинается с символа ' (апостроф). Тогда в __GetValue()__ этот символ отсутствует. Это нужно, если мы хотим начать текст со знака "=", но не хотим, чтобы он интерпретировался как формула.
Например, ячейка задана строкой "'=1+2".
> GetText() от неё "'=1+2";
> 
> GetValue() от неё "=1+2".
